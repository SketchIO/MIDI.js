<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8" />

	<!-- shims -->
	<script src="../inc/shim/Base64.js"></script>
	<script src="../inc/shim/WebAudioAPI.js"></script>
	<script src="../inc/shim/WebMIDIAPI.js"></script>

	<!-- utils -->
	<script src="../inc/dom/request_script.js"></script>
	<script src="../inc/dom/request_xhr.js"></script>
	<script src="../inc/EventEmitter.js"></script>

	<script src="../build/MIDI.js"></script>

</head>
<body>
<script>

window.onload = function () {
	MIDI.startDebugging()
	MIDI.WebAudioSM.connect()
	MIDI.autoselectFormat()
	MIDI.loadProgram({
		intoSlot: 0,
		filename: './soundfont/acoustic_grand_piano-%FORMAT.json',
		onProgress(state, progress) {
			console.log('Loading:', progress.toFixed(2), '%')
		}
	})
	MIDI.isReady().then(function() {
		var delay = 0 // play one note every quarter second
		var note = 50 // the MIDI note
		var velocity = 127 // how hard the note hits

		MIDI.setVolume(0, 127)
		MIDI.noteOn(0, note, velocity, delay)
		MIDI.noteOff(0, note, delay + 0.75)
	})
}

</script>
</body>
</html>